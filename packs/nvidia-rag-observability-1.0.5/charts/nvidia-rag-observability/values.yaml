# Default values for nvidia-rag-observability

global:
  namespace: "nvidia-rag"
  storageClass: "gp3-data"

# OpenTelemetry Collector
otelCollector:
  enabled: true
  image:
    repository: "otel/opentelemetry-collector-contrib"
    tag: "0.140.0"
    pullPolicy: IfNotPresent
  replicaCount: 1
  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
    limits:
      memory: "1Gi"
      cpu: "1"
  service:
    type: ClusterIP
    ports:
      otlpGrpc: 4317
      otlpHttp: 4318
      prometheus: 8889
      health: 13133
  config:
    receivers:
      otlp:
        protocols:
          grpc:
            endpoint: "0.0.0.0:4317"
          http:
            endpoint: "0.0.0.0:4318"
    processors:
      batch:
        timeout: 1s
        send_batch_size: 1024
    exporters:
      zipkin:
        endpoint: "http://rag-zipkin:9411/api/v2/spans"
      prometheus:
        endpoint: "0.0.0.0:8889"
      debug:
        verbosity: basic
    service:
      pipelines:
        traces:
          receivers: [otlp]
          processors: [batch]
          exporters: [zipkin, debug]
        metrics:
          receivers: [otlp]
          processors: [batch]
          exporters: [prometheus, debug]

# Zipkin
zipkin:
  enabled: true
  image:
    repository: "docker.io/openzipkin/zipkin"
    tag: "3.5.0"
    pullPolicy: IfNotPresent
  replicaCount: 1
  resources:
    requests:
      memory: "4Gi"
      cpu: "1"
    limits:
      memory: "8Gi"
      cpu: "2"
  service:
    type: ClusterIP
    port: 9411
  javaOpts: "-Xms4g -Xmx8g -XX:+ExitOnOutOfMemoryError"

# Prometheus
prometheus:
  enabled: true
  image:
    repository: "prom/prometheus"
    tag: "latest"
    pullPolicy: IfNotPresent
  replicaCount: 1
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi"
      cpu: "1"
  service:
    type: ClusterIP
    port: 9090
  persistence:
    enabled: true
    storageClass: ""
    size: "20Gi"
  retention: "1h"
  scrapeConfigs:
    - job_name: "rag-server"
      scrape_interval: "5s"
      static_configs:
        - targets: ["rag-rag-server:8081"]
    - job_name: "otel-collector"
      scrape_interval: "5s"
      static_configs:
        - targets: ["rag-otel-collector:8889"]

# Grafana
grafana:
  enabled: true
  image:
    repository: "grafana/grafana"
    tag: "latest"
    pullPolicy: IfNotPresent
  replicaCount: 1
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 3000
  persistence:
    enabled: true
    storageClass: ""
    size: "10Gi"
  adminUser: "admin"
  adminPassword: ""
  datasources:
    - name: Prometheus
      type: prometheus
      url: "http://rag-prometheus:9090"
      isDefault: true
